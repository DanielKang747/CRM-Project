package customerCare;

import java.awt.BorderLayout;
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JDialog;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.KeyStroke;

public class GUIForMemberDialog {
	
	public static Calendar cal = Calendar.getInstance();
	
	public static JDialog jDialog = new JDialog(GUIForCustomerCare.jFrame, "Customer Info Input");
	public static JDialog jDialogForAuto = new JDialog(GUIForCustomerCare.jFrame, "Automobile Info Input");
	public static JDialog jDialogForHome = new JDialog(GUIForCustomerCare.jFrame, "Home Info Input");
	public static JDialog jDialogForTravel = new JDialog(GUIForCustomerCare.jFrame, "Travel Info Input");
	public static JDialog jDialogForCommercial = new JDialog(GUIForCustomerCare.jFrame, "Commercial Info Input");
	public static JDialog jDialogUpdate = new JDialog(GUIForCustomerCare.jFrame, "Update");
	public static JDialog jDialogUpdateForAuto = new JDialog(GUIForCustomerCare.jFrame, "Automobile Update");
	public static JDialog jDialogUpdateForHome = new JDialog(GUIForCustomerCare.jFrame, "Home Update");
	public static JDialog jDialogUpdateForTravel = new JDialog(GUIForCustomerCare.jFrame, "Travel Update");
	public static JDialog jDialogUpdateForCommercial = new JDialog(GUIForCustomerCare.jFrame, "Commercial Update");
	
	public static JButton submitButton = new JButton("Register");
	public static JButton cancelButton = new JButton("Cancel");
	
	public static JPanel fieldNamePanel = new JPanel(new GridLayout(0,1));
	public static JPanel fieldValuePanel = new JPanel(new GridLayout(0,1));
	public static JPanel buttonPanel = new JPanel(new FlowLayout());
	public static JPanel buttonPanelForAuto = new JPanel(new FlowLayout());
	public static JPanel idPanel = new JPanel(new BorderLayout());
	public static JPanel idPanelForAuto = new JPanel(new BorderLayout());
	public static JPanel timeStampPanelForAuto = new JPanel(new BorderLayout());
	public static JPanel premiumPanelForAuto = new JPanel(new BorderLayout());

	public static JLabel idLabel = new JLabel("ID");
	public static JLabel lastNameLabel = new JLabel("Last Name");
	public static JLabel firstNameLabel = new JLabel("First Name");
	public static JLabel cellLabel= new JLabel("Phone #");
	public static JLabel birthDateLabel= new JLabel("Birth Date");
	public static JLabel emailLabel = new JLabel("Email");
	public static JLabel priCustIDLabel = new JLabel("Primary ID");
	public static JLabel memoLabel = new JLabel("Memo");
	public static JLabel postalCdLabel = new JLabel("Postal Code");
	public static JLabel addrStNumLabel = new JLabel("Address");
	public static JLabel addrPvNumLabel = new JLabel("City/Prov.");
	
	public static JLabel idLabelForAuto = new JLabel("ID");
	public static JLabel timeStampLabel = new JLabel("Time Stamp");
	public static JLabel txnTypeLabel = new JLabel("Txn Type");
	public static JLabel plateNoLabel = new JLabel("Plate #");
	public static JLabel docNoLabel = new JLabel("Doc #");
	public static JLabel expDatelabel = new JLabel("Expiry Date");
	public static JLabel newExpDatelabel = new JLabel("New Expiry Date");
	public static JLabel procTypeLabel = new JLabel("Proc Type");
	public static JLabel premiumLabel = new JLabel("Premium");
	public static JLabel textDateTime = new JLabel("Text Date");
	public static JLabel callDateTime = new JLabel("Call Date");
	public static JLabel visitDateTime = new JLabel("Visit Date");
	public static JLabel completeDateLabel = new JLabel("Complete Date");
	public static JLabel companyNameLabel = new JLabel("Company Name");
	public static JLabel onwerLabel = new JLabel("Owner");
	
	public static JLabel effDateLabel = new JLabel("Eff Date");
	public static JLabel sigxpNoLabel = new JLabel("Sigxp No");
	public static JLabel mailDateTimeLabel = new JLabel("Mail Date");
	public static JLabel crtDateTimeLabel = new JLabel("Crt Date Time");
	public static JLabel policyNoLabel = new JLabel("Policy #");
	
	public static JTextField idField = new JTextField(20);
	public static JTextField lastNameField = new JTextField(20);
	public static JTextField firstNameField = new JTextField(20);
	public static JTextField cellField = new JTextField(20);
	
	public static JTextField birthDateTextField = new JTextField();
	public static JTextField emailTextField = new JTextField(20);
	public static JTextField priCustIDTextField = new JTextField(20);
	public static JTextArea memoTextField = new JTextArea();
	public static JScrollPane memoTextFieldArea = new JScrollPane(memoTextField);
	public static JTextField postalCdField = new JTextField(20);
	public static JTextField addrStrtNumTextField = new JTextField(20);
	public static JTextField addrPvNumTextField = new JTextField(20);

	public static JTextField idFieldForAuto = new JTextField(20);
	public static JTextField idFieldForHome = new JTextField(20);
	public static JTextField idFieldForTravel = new JTextField(20);
	public static JTextField idFieldForCommercial = new JTextField(20);		
	public static JTextField timeStampField = new JTextField(20);
	public static String[] txnTypeStrings = {"NEW BIZ", "RENEWAL", "CHANGE", "CANCEL", "CLAIM"};
	public static String[] txnTypeStringsForAutomobile = {"NEW PLATE", "RENEWAL", "TRANSFER", "CHANGE", "CANCEL", "CLAIM", "AMEND"};
	public static JComboBox<String> txnTypeField = new JComboBox<String>(txnTypeStrings);
	public static JComboBox<String> txnTypeFieldForAuto = new JComboBox<String>(txnTypeStringsForAutomobile);
	public static JTextField plateNoField = new JTextField(20);
	public static JTextField docNoField = new JTextField(20);
	public static JTextField expDateField = new JTextField(20);
	public static JTextField newExpDateField = new JTextField(20);
	public static String[] procTypeStrings = { "READY", "ONGOING", "WAITING", "RESERVED", "COMPLETE", "SUCCESS", "FAIL", "NEXT", "OPEN", "CLOSE"};
	public static JComboBox<String> procTypeField = new JComboBox<String>(procTypeStrings);
	public static JTextField premiumField = new JTextField(20);
	public static JTextField premiumFieldForAuto = new JTextField(20);
	public static JTextField premiumFieldForHome = new JTextField(20);
	public static JTextField premiumFieldForTravel = new JTextField(20);
	public static JTextField premiumFieldForCommercial = new JTextField(20);
	public static JTextField textDateTimeField = new JTextField();
	public static JTextField callDateTimeField = new JTextField();
	public static JTextField visitDateTimeField = new JTextField();
	public static JTextField completeDateField = new JTextField();
	public static JTextField companyNameField = new JTextField();
	public static JTextField ownerField = new JTextField(20);
	
	public static JTextField effDateField = new JTextField();
	public static JTextField mailDateTimeField = new JTextField();
	public static JTextField sigxpNoField = new JTextField(20);
	public static JTextField crtDateTimeField = new JTextField();
	public static JTextField policyNoField = new JTextField();
	
	public static void main(String[] args) {
		
		Action currentDate = new AbstractAction() {
		    /**
			 * 
			 */
			private static final long serialVersionUID = 1L;

			public void actionPerformed(ActionEvent e) {
		    	
		    	   DateFormat dateFormat = new SimpleDateFormat("yyyyMMdd");
		    	   
		    	   Date date = new Date();
		    	   if (effDateField.hasFocus()) {
		    		   effDateField.setText(dateFormat.format(date));
		    	   }
		    	   else if (mailDateTimeField.hasFocus()) {
		    		   mailDateTimeField.setText(dateFormat.format(date));
		    	   }
		    	   else if (crtDateTimeField.hasFocus()) {
		    		   crtDateTimeField.setText(dateFormat.format(date));
		    	   }
		    	   else if (textDateTimeField.hasFocus()) {
		    		   textDateTimeField.setText(dateFormat.format(date));
		    	   }
		    	   else if (callDateTimeField.hasFocus()) {
		    		   callDateTimeField.setText(dateFormat.format(date));
		    	   }
		    	   else if (visitDateTimeField.hasFocus()) {
		    		   visitDateTimeField.setText(dateFormat.format(date));
		    	   }
		    	   else if (completeDateField.hasFocus()) {
		    		   completeDateField.setText(dateFormat.format(date));
		    	   }
		    	   else if (expDateField.hasFocus()) {
		    		   expDateField.setText(dateFormat.format(date));
		    	   }
		    	   else if (newExpDateField.hasFocus()) {
		    		   newExpDateField.setText(dateFormat.format(date));
		    	   }
		    }
		};
		
		Action expDateChange = new AbstractAction() {
		    /**
			 * 
			 */
			private static final long serialVersionUID = 1L;

			public void actionPerformed(ActionEvent e) {
		    				    	   
		    	   if (effDateField.hasFocus()) {
		    		   effDateField.setText(expDateField.getText());
		    	   }
		    	   else if (mailDateTimeField.hasFocus()) {
		    		   mailDateTimeField.setText(expDateField.getText());
		    	   }
		    	   else if (crtDateTimeField.hasFocus()) {
		    		   crtDateTimeField.setText(expDateField.getText());
		    	   }
		    	   else if (textDateTimeField.hasFocus()) {
		    		   textDateTimeField.setText(expDateField.getText());
		    	   }
		    	   else if (callDateTimeField.hasFocus()) {
		    		   callDateTimeField.setText(expDateField.getText());
		    	   }
		    	   else if (visitDateTimeField.hasFocus()) {
		    		   visitDateTimeField.setText(expDateField.getText());
		    	   }
		    	   else if (completeDateField.hasFocus()) {
		    		   completeDateField.setText(expDateField.getText());
		    	   }
		    	   else if (expDateField.hasFocus()) {
		    		   expDateField.setText(expDateField.getText());
		    	   }
		    	   else if (newExpDateField.hasFocus()) {
		    		   newExpDateField.setText(expDateField.getText());
		    	   }
		    }
		};
		
		effDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
                "currentDate");
		effDateField.getActionMap().put("currentDate",
		currentDate);
		
		effDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		effDateField.getActionMap().put("expDateChange",
		expDateChange);
		
		mailDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		mailDateTimeField.getActionMap().put("currentDate",
		currentDate);
		
		mailDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		mailDateTimeField.getActionMap().put("expDateChange",
		expDateChange);
		
		crtDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		crtDateTimeField.getActionMap().put("currentDate",
		currentDate);
		
		crtDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		crtDateTimeField.getActionMap().put("expDateChange",
		expDateChange);
		
		textDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		textDateTimeField.getActionMap().put("currentDate",
		currentDate);
		
		textDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		textDateTimeField.getActionMap().put("expDateChange",
		expDateChange);
		
		callDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		callDateTimeField.getActionMap().put("currentDate",
		currentDate);
		
		callDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		callDateTimeField.getActionMap().put("expDateChange",
		expDateChange);
		
		visitDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		visitDateTimeField.getActionMap().put("currentDate",
		currentDate);
		
		visitDateTimeField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		visitDateTimeField.getActionMap().put("expDateChange",
		expDateChange);
		
		completeDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		completeDateField.getActionMap().put("currentDate",
		currentDate);
		
		completeDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		completeDateField.getActionMap().put("expDateChange",
		expDateChange);
		
		expDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		expDateField.getActionMap().put("currentDate",
		currentDate);
		
		expDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		expDateField.getActionMap().put("expDateChange",
		expDateChange);
		
		newExpDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_T, java.awt.event.InputEvent.META_DOWN_MASK),
		"currentDate");
		
		newExpDateField.getActionMap().put("currentDate",
		currentDate);
		
		newExpDateField.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_R, java.awt.event.InputEvent.META_DOWN_MASK),
		"expDateChange");
		
		newExpDateField.getActionMap().put("expDateChange",
		expDateChange);
		
		submitButton.addActionListener(new ActionListener()
		{
			@Override
			public void actionPerformed(ActionEvent e) {
				switch (MemberDialog.getNewInfo()) {
					case DatabaseConstant.CUSTOMER_MODE:
						if (GUIForMemberDialog.lastNameField.getText().trim().length() == 0 ) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input last name!");
							GUIForMemberDialog.lastNameField.requestFocus();
						}
						else if (GUIForMemberDialog.firstNameField.getText().trim().length() == 0) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input first name!");
							GUIForMemberDialog.firstNameField.requestFocus();
						}
						else { // No Error	
							switch (MemberDialog.getDialogMode()) {
								case DatabaseConstant.NEW_MODE:
									if (CustomerCare.submitMember(MemberDialog.getDialogMode(), GUIForMemberDialog.idField.getText().trim(), 
																		 	  GUIForMemberDialog.lastNameField.getText().trim(), 
																			  GUIForMemberDialog.firstNameField.getText().trim(), 
																			  GUIForMemberDialog.cellField.getText().trim(), 
																			  GUIForMemberDialog.birthDateTextField.getText().trim(),
																			  GUIForMemberDialog.emailTextField.getText().trim(), 
																			  GUIForMemberDialog.priCustIDTextField.getText().trim(), 
																			  GUIForMemberDialog.memoTextField.getText().trim(), 
																			  GUIForMemberDialog.postalCdField.getText().trim(), 
																			  GUIForMemberDialog.addrStrtNumTextField.getText().trim(), 
																			  GUIForMemberDialog.addrPvNumTextField.getText().trim())) {
										try {
											if (GUIForMemberDialog.priCustIDTextField.getText().isEmpty()) {
												Utilities.connection = DriverManager.getConnection(DatabaseConstant.URL, DatabaseConstant.USER, DatabaseConstant.PASSWORD);

												Utilities.preparedStatement = Utilities.connection.prepareStatement("UPDATE CCCUSTOM SET PRI_CUST_ID = NULL WHERE length((rtrim(PRI_CUST_ID)))=0;");
				
												Utilities.preparedStatement.executeUpdate();
											}
										} catch (SQLException e1) {
											JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "MemberDialog - submitButton - CustomerMode - NewMode - Error");
											System.out.println("MemberDialog - submitButton - CustomerMode - NewMode" +  e1.getStackTrace());
										}
		
										CustomerCare.searchMember(DatabaseConstant.SEARCH_CUSTOMER, GUIForMemberDialog.idField.getText().trim());
		
										CustomerCare.customerID = (String) GUIForCustomerCare.jTable_Personal_Info.getValueAt(0, 0);

										CustomerCare.selectDetailedInfo(CustomerCare.customerID);
										CustomerCare.selectFamilyInfo(GUIForCustomerCare.idTextField.getText().trim());
										CustomerCare.selectAutomobileInfo(GUIForCustomerCare.idTextField.getText().trim());
										CustomerCare.selectHomeInfo(GUIForCustomerCare.idTextField.getText().trim());
										CustomerCare.selectCommercialInfo(GUIForCustomerCare.idTextField.getText().trim());
										CustomerCare.selectTravelInfo(GUIForCustomerCare.idTextField.getText().trim());
										
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Register Completed!");
										GUIForCustomerCare.customerButton.setSelected(false);
										GUIForCustomerCare.allButton.setSelected(false);
									}
									break;
								case DatabaseConstant.EDIT_MODE:
									if (CustomerCare.submitMember(MemberDialog.getDialogMode(), GUIForMemberDialog.idField.getText().trim(), 
																			  GUIForMemberDialog.lastNameField.getText().trim(), 
																			  GUIForMemberDialog.firstNameField.getText().trim(), 
																			  GUIForMemberDialog.cellField.getText().trim(), 
																			  GUIForMemberDialog.birthDateTextField.getText().trim(),
																			  GUIForMemberDialog.emailTextField.getText().trim(), 
																			  GUIForMemberDialog.priCustIDTextField.getText().trim(), 
																			  GUIForMemberDialog.memoTextField.getText().trim(), 
																			  GUIForMemberDialog.postalCdField.getText().trim(), 
																			  GUIForMemberDialog.addrStrtNumTextField.getText().trim(), 
																			  GUIForMemberDialog.addrPvNumTextField.getText().trim())) {
										
										CustomerCare.selectDetailedInfo(GUIForCustomerCare.idTextField.getText().trim());
										CustomerCare.selectFamilyInfo(GUIForCustomerCare.idTextField.getText().trim());
		
										try {
											if (GUIForMemberDialog.priCustIDTextField.getText().isEmpty()) {
				
												Utilities.connection = DriverManager.getConnection(DatabaseConstant.URL, DatabaseConstant.USER, DatabaseConstant.PASSWORD);

												Utilities.preparedStatement = Utilities.connection.prepareStatement("UPDATE CCCUSTOM SET PRI_CUST_ID = NULL WHERE length((rtrim(PRI_CUST_ID)))=0;");
				
												Utilities.preparedStatement.executeUpdate();
											}
										} catch (SQLException e1) {
											JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "update primaryCustID error", "Customer Update", JOptionPane.ERROR_MESSAGE);
											System.out.println("MemberDialog - submitButton - editMode - Error " +  e1.getStackTrace());
										}
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogUpdate, "Succesfully Updated!");
									}
									GUIForMemberDialog.jDialogUpdate.dispose();
									break;
							}	
						}
						break;
					case DatabaseConstant.AUTOMOBILE_MODE:
						if (GUIForMemberDialog.plateNoField.getText().trim().length() == 0 ) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input plate number!");
							GUIForMemberDialog.plateNoField.requestFocus();
						}
						else if (GUIForMemberDialog.expDateField.getText().trim().length() == 0) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input expiry date!");
							GUIForMemberDialog.expDateField.requestFocus();
						}
						else { // No Error			
							switch (MemberDialog.getDialogMode()) {
								case DatabaseConstant.NEW_MODE:
									if (CustomerCare.submitMemberForAuto(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForAuto.getText().trim(), 
																					 GUIForMemberDialog.timeStampField.getText().trim(), 
																					(String)GUIForMemberDialog.txnTypeFieldForAuto.getSelectedItem(),
																					 GUIForMemberDialog.plateNoField.getText().trim(), 
																					 GUIForMemberDialog.docNoField.getText().trim(), 
																					 GUIForMemberDialog.expDateField.getText().trim(), 
																					 GUIForMemberDialog.newExpDateField.getText().trim(), 
																					 (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																					 GUIForMemberDialog.premiumFieldForAuto.getText().trim(), 
																					 GUIForMemberDialog.textDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.callDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.visitDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.completeDateField.getText().trim(), 
																					 GUIForMemberDialog.companyNameField.getText().trim(), 
																					 GUIForMemberDialog.ownerField.getText().trim(), 
																					 GUIForMemberDialog.memoTextField.getText().trim(), 
																					 GUIForMemberDialog.postalCdField.getText().trim(), 
																					 GUIForMemberDialog.addrStrtNumTextField.getText().trim(), 
																					 GUIForMemberDialog.addrPvNumTextField.getText().trim())) {
										
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogForAuto, "Register Completed!");
										CustomerCare.selectAutomobileInfo(GUIForMemberDialog.idFieldForAuto.getText().trim());
									}	
									GUIForMemberDialog.jDialogForAuto.dispose();
									break;
								case DatabaseConstant.EDIT_MODE:
									if (CustomerCare.submitMemberForAuto(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForAuto.getText().trim(), 
																					 GUIForMemberDialog.timeStampField.getText().trim(), 
																					(String)GUIForMemberDialog.txnTypeFieldForAuto.getSelectedItem(),
																					 GUIForMemberDialog.plateNoField.getText().trim(), 
																					 GUIForMemberDialog.docNoField.getText().trim(), 
																					 GUIForMemberDialog.expDateField.getText().trim(), 
																					 GUIForMemberDialog.newExpDateField.getText().trim(), 
																					 (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																					 GUIForMemberDialog.premiumFieldForAuto.getText().trim(), 
																					 GUIForMemberDialog.textDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.callDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.visitDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.completeDateField.getText().trim(), 
																					 GUIForMemberDialog.companyNameField.getText().trim(), 
																					 GUIForMemberDialog.ownerField.getText().trim(), 
																					 GUIForMemberDialog.memoTextField.getText().trim(), 
																					 GUIForMemberDialog.postalCdField.getText().trim(), 
																					 GUIForMemberDialog.addrStrtNumTextField.getText().trim(), 
																					 GUIForMemberDialog.addrPvNumTextField.getText().trim())) {
										
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogUpdate, "Succesfully Updated!");
										CustomerCare.selectAutomobileInfo(GUIForMemberDialog.idFieldForAuto.getText().trim());
									}	
									GUIForMemberDialog.jDialogUpdateForAuto.dispose();
									break;
							}
						}
						break;
					case DatabaseConstant.HOME_MODE:
						if (GUIForMemberDialog.expDateField.getText().trim().length() == 0 ) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input expiry date!");
							GUIForMemberDialog.expDateField.requestFocus();
						}
						else if (GUIForMemberDialog.txnTypeFieldForAuto.getSelectedItem().toString().length() == 0) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input txn type!");
							GUIForMemberDialog.txnTypeField.requestFocus();
						}
						else { // No Error	
							switch (MemberDialog.getDialogMode()) {
								case DatabaseConstant.NEW_MODE:
									if (CustomerCare.submitMemberForHome(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForHome.getText().trim(), 
																				 	 GUIForMemberDialog.timeStampField.getText().trim(), 
																				 	 GUIForMemberDialog.expDateField.getText().trim(), 
																					 GUIForMemberDialog.newExpDateField.getText().trim(), 
																					 (String)GUIForMemberDialog.txnTypeField.getSelectedItem(), 
																					 (String)GUIForMemberDialog.procTypeField.getSelectedItem(),
																					 GUIForMemberDialog.sigxpNoField.getText().trim(), 
																					 GUIForMemberDialog.premiumFieldForHome.getText().trim(), 
																					 GUIForMemberDialog.textDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.callDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.visitDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.completeDateField.getText().trim(), 
																					 GUIForMemberDialog.companyNameField.getText().trim(), 
																					 GUIForMemberDialog.ownerField.getText().trim(), 
																					 GUIForMemberDialog.memoTextField.getText().trim(),
																					 GUIForMemberDialog.postalCdField.getText().trim(), 
																					 GUIForMemberDialog.addrStrtNumTextField.getText().trim(), 
																					 GUIForMemberDialog.addrPvNumTextField.getText().trim())) {								

										CustomerCare.selectHomeInfo(GUIForMemberDialog.idFieldForHome.getText().trim());
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogForHome, "Register Completed!");
									}
									GUIForMemberDialog.jDialogForHome.dispose();
									break;
								case DatabaseConstant.EDIT_MODE:
									if (CustomerCare.submitMemberForHome(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForHome.getText().trim(), 
																					 GUIForMemberDialog.timeStampField.getText().trim(), 
																					 GUIForMemberDialog.expDateField.getText().trim(), 
																					 GUIForMemberDialog.newExpDateField.getText().trim(), 
																					 (String)GUIForMemberDialog.txnTypeField.getSelectedItem(), 
																					 (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																					 GUIForMemberDialog.sigxpNoField.getText().trim(), 
																					 GUIForMemberDialog.premiumFieldForHome.getText().trim(), 
																					 GUIForMemberDialog.textDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.callDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.visitDateTimeField.getText().trim(), 
																					 GUIForMemberDialog.completeDateField.getText().trim(), 
																					 GUIForMemberDialog.companyNameField.getText().trim(), 
																					 GUIForMemberDialog.ownerField.getText().trim(), 
																					 GUIForMemberDialog.memoTextField.getText().trim(), 
																					 GUIForMemberDialog.postalCdField.getText().trim(), 
																					 GUIForMemberDialog.addrStrtNumTextField.getText().trim(), 
																					 GUIForMemberDialog.addrPvNumTextField.getText().trim())) {								
										
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogUpdate, "Succesfully Updated!");
										CustomerCare.selectHomeInfo(GUIForMemberDialog.idFieldForHome.getText().trim());
									}
									GUIForMemberDialog.jDialogUpdateForHome.dispose();
									break;
							}
						}
						break;
					case DatabaseConstant.TRAVEL_MODE:
						if (GUIForMemberDialog.txnTypeField.getSelectedItem().toString().length() == 0 ) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input Txn Type!");
							GUIForMemberDialog.txnTypeField.requestFocus();
						}
						else if (GUIForMemberDialog.expDateField.getText().trim().length() == 0) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input expiry date!");
							GUIForMemberDialog.expDateField.requestFocus();
						}
						else { // No Error	
							switch (MemberDialog.getDialogMode()) {
								case DatabaseConstant.NEW_MODE:
									if (CustomerCare.submitMemberForTravel(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForTravel.getText().trim(), 
																					   GUIForMemberDialog.timeStampField.getText().trim(), 
																					   GUIForMemberDialog.effDateField.getText().trim(), 
																					   GUIForMemberDialog.expDateField.getText().trim(), 
																					   (String)GUIForMemberDialog.txnTypeField.getSelectedItem(),
																					   (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																					   GUIForMemberDialog.policyNoField.getText().trim(), 
																					   GUIForMemberDialog.premiumFieldForTravel.getText().trim(), 
																					   GUIForMemberDialog.textDateTimeField.getText().trim(),
																					   GUIForMemberDialog.callDateTimeField.getText().trim(), 
																					   GUIForMemberDialog.mailDateTimeField.getText().trim(), 
																					   GUIForMemberDialog.completeDateField.getText().trim(), 
																					   GUIForMemberDialog.companyNameField.getText().trim(), 
																					   GUIForMemberDialog.ownerField.getText().trim(), 
																					   GUIForMemberDialog.memoTextField.getText().trim())) {		
										
										CustomerCare.selectTravelInfo(GUIForMemberDialog.idFieldForTravel.getText().trim());
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogForTravel, "Register Completed!");
									}
									GUIForMemberDialog.jDialogForTravel.dispose();
									break;
								case DatabaseConstant.EDIT_MODE:
									if (CustomerCare.submitMemberForTravel(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForTravel.getText().trim(), 
																					   GUIForMemberDialog.timeStampField.getText().trim(), 
																					   GUIForMemberDialog.effDateField.getText().trim(), 
																					   GUIForMemberDialog.expDateField.getText().trim(), 
																					   (String)GUIForMemberDialog.txnTypeField.getSelectedItem(), 
																					   (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																					   GUIForMemberDialog.policyNoField.getText().trim(), 
																					   GUIForMemberDialog.premiumFieldForTravel.getText().trim(), 
																					   GUIForMemberDialog.textDateTimeField.getText().trim(),
																					   GUIForMemberDialog.callDateTimeField.getText().trim(), 
																					   GUIForMemberDialog.mailDateTimeField.getText().trim(), 
																					   GUIForMemberDialog.completeDateField.getText().trim(), 
																					   GUIForMemberDialog.companyNameField.getText().trim(), 
																					   GUIForMemberDialog.ownerField.getText().trim(), 
																					   GUIForMemberDialog.memoTextField.getText().trim())) {	
										
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogUpdate, "Succesfully Updated!");
										CustomerCare.selectTravelInfo(GUIForMemberDialog.idFieldForTravel.getText().trim());
									}	
									GUIForMemberDialog.jDialogUpdateForTravel.dispose();
									break;
							}
						}
						break;
					case DatabaseConstant.COMMERCIAL_MODE:
						if (GUIForMemberDialog.txnTypeField.getSelectedItem().toString().length() == 0 ) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input Txn Type!");
							GUIForMemberDialog.txnTypeField.requestFocus();
						}
						else if (GUIForMemberDialog.expDateField.getText().trim().length() == 0) {
							JOptionPane.showMessageDialog(GUIForMemberDialog.jDialog, "Please input expiry date!");
							GUIForMemberDialog.expDateField.requestFocus();
						}
						else { // No Error		
							switch (MemberDialog.getDialogMode()) {
								case DatabaseConstant.NEW_MODE:
									if (CustomerCare.submitMemberForCommercial(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForCommercial.getText().trim(), 
																						   GUIForMemberDialog.timeStampField.getText().trim(), 
																						   GUIForMemberDialog.expDateField.getText().trim(), 
																						   GUIForMemberDialog.newExpDateField.getText().trim(),  
																						   (String)GUIForMemberDialog.txnTypeField.getSelectedItem(), 
																						   (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																						   GUIForMemberDialog.sigxpNoField.getText().trim(), 
																						   GUIForMemberDialog.premiumFieldForCommercial.getText().trim(), 
																						   GUIForMemberDialog.textDateTimeField.getText().trim(),
																						   GUIForMemberDialog.callDateTimeField.getText().trim(), 
																						   GUIForMemberDialog.visitDateTimeField.getText().trim(), 
																						   GUIForMemberDialog.completeDateField.getText().trim(), 
																						   GUIForMemberDialog.companyNameField.getText().trim(), 
																						   GUIForMemberDialog.ownerField.getText().trim(), 
																						   GUIForMemberDialog.memoTextField.getText().trim())) {								

										CustomerCare.selectCommercialInfo(GUIForMemberDialog.idFieldForCommercial.getText().trim());
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogForCommercial, "Register Completed!");
									}	
									GUIForMemberDialog.jDialogForCommercial.dispose();
									break;
								case DatabaseConstant.EDIT_MODE:
									if (CustomerCare.submitMemberForCommercial(MemberDialog.getDialogMode(), GUIForMemberDialog.idFieldForCommercial.getText().trim(), 
																						   GUIForMemberDialog.timeStampField.getText().trim(), 
																						   GUIForMemberDialog.expDateField.getText().trim(), 
																						   GUIForMemberDialog.newExpDateField.getText().trim(),  
																						   (String)GUIForMemberDialog.txnTypeField.getSelectedItem(), 
																						   (String)GUIForMemberDialog.procTypeField.getSelectedItem(), 
																						   GUIForMemberDialog.sigxpNoField.getText().trim(), 
																						   GUIForMemberDialog.premiumFieldForCommercial.getText().trim(), 
																						   GUIForMemberDialog.textDateTimeField.getText().trim(),
																						   GUIForMemberDialog.callDateTimeField.getText().trim(), 
																						   GUIForMemberDialog.visitDateTimeField.getText().trim(), 
																						   GUIForMemberDialog.completeDateField.getText().trim(), 
																						   GUIForMemberDialog.companyNameField.getText().trim(), 
																						   GUIForMemberDialog.ownerField.getText().trim(), 
																						   GUIForMemberDialog.memoTextField.getText().trim())) {
										
										JOptionPane.showMessageDialog(GUIForMemberDialog.jDialogUpdate, "Succesfully Updated!");
										CustomerCare.selectCommercialInfo(GUIForMemberDialog.idFieldForCommercial.getText().trim());
									}
									GUIForMemberDialog.jDialogUpdateForCommercial.dispose();
									break;
							}
						}	
						break;
				}
			}
		});
	}
}
